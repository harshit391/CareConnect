arr = [
    "cmatmdbra0000i01ga4mcookr",
    "cmatmdbri0001i01gd8m5bgsc",
    "cmatmdbri0002i01gwx5opdrt",
    "cmatmdbri0003i01gqoh6gnjk",
    "cmatmdbri0004i01gtyl2f7qa",
    "cmatmdbri0005i01gjb5d0mg5",
    "cmatmdbri0006i01guvmvg46v",
    "cmatmdbrj0007i01gn2v6np9e",
    "cmatmdbrj0008i01ggh0ituue",
    "cmatmdbrj0009i01gotptxx9b",
    "cmatmdbrj000ai01g4bhe19hy",
    "cmatmdbrj000bi01gyl6waufc",
    "cmatmdbrj000ci01gibg9nr7x",
    "cmatmdbrj000di01gla2zad02",
    "cmatmdbrj000ei01gi2lwnhn3",
    "cmatmdbrj000fi01g9czq3n1p",
    "cmatmdbrj000gi01gxvwgg88t",
    "cmatmdbrj000hi01gys4s9itl",
    "cmatmdbrk000ii01gu8n10b75",
    "cmatmdbrk000ji01g5mtseg0z",
    "cmatmdbrk000ki01gp3dhyxs7",
    "cmatmdbrk000li01gwm24s1uk",
    "cmatmdbrk000mi01g3t234f8l",
    "cmatmdbrk000ni01gll494hqd",
    "cmatmdbrk000oi01gxlpootqj",
    "cmatmdbrk000pi01gf67z3wwk",
    "cmatmdbrk000qi01gx2vzqlt5",
    "cmatmdbrk000ri01graka2zzb",
    "cmatmdbrk000si01gtzvwvki1",
    "cmatmdbrk000ti01g6lmzlytx",
    "cmatmdbrk000ui01gnlpv5l85",
    "cmatmdbrl000vi01ghelxg4kv",
    "cmatmdbrl000wi01gwars3m4v",
    "cmatmdbrl000xi01g5dofchxo",
    "cmatmdbrl000yi01gbbbhct3j",
    "cmatmdbrl000zi01gsdlpg2mp",
    "cmatmdbrl0010i01gjg1rtno2",
    "cmatmdbrl0011i01g7t2rm6mz",
    "cmatmdbrl0012i01gkwu7fp4q",
    "cmatmdbrl0013i01gnh4ejs57",
    "cmatmdbrl0014i01gcycjdnu5",
    "cmatmdbrl0015i01glx8ifgj7",
    "cmatmdbrl0016i01gpwdbi760",
];

doctorIds = [
    "cmatmnxxw0001i0zkmqp8y9ti",
    "cmatmo13i0003i0zkh2xc265u",
    "cmatmo3i50005i0zklngyzjw1",
    "cmatmo5w50007i0zk1t1zdekb",
    "cmatmo8ik0009i0zkzmm4dkph",
    "cmatmob4t000bi0zkdv3w04s7",
    "cmatmodim000di0zklko8f2vq",
    "cmatmofwd000fi0zk07ikarij",
    "cmatmoia6000hi0zkh3ylqqho",
    "cmatmokwr000ji0zk9m3hh7ki",
    "cmatmonje000li0zkq26scujq",
    "cmatmopxh000ni0zkp4n2ckef",
    "cmatmosbh000pi0zkt5za05bu",
    "cmatmoup8000ri0zkhjc7mo6k",
    "cmatmoxbx000ti0zknm8q3djc",
    "cmatmozym000vi0zk28wq88rb",
    "cmatmp2cr000xi0zkurcwspqe",
    "cmatmp4qn000zi0zkhb941oxv",
    "cmatmp7450011i0zk6c4t5wvg",
    "cmatmp9qc0013i0zkexho6nts",
    "cmatmpccn0015i0zkgeyqx345",
    "cmatmperb0017i0zkfbgznz75",
    "cmatmph5j0019i0zkd83u8it5",
    "cmatmpjj6001bi0zk8rv93qz1",
    "cmatmpm59001di0zk8nutiq6c",
    "cmatmpore001fi0zk1l0qat9g",
    "cmatmpr57001hi0zkb1esdrzx",
    "cmatmptjb001ji0zkegz3e1dt",
    "cmatmpvxi001li0zk8uptnvx6",
    "cmatmpyjd001ni0zkgavse2xw",
    "cmatmq16j001pi0zkn2cicbla",
    "cmatmq3kb001ri0zk8dalxt69",
    "cmatmq5yd001ti0zk85i5rsh6",
    "cmatmq8bv001vi0zk5zos2xym",
    "cmatmqayd001xi0zkij28d9qg",
    "cmatmqdmp001zi0zku7lexixd",
    "cmatmqg0b0021i0zkhrt9kmoh",
    "cmatmqidr0023i0zk03cdg9sq",
    "cmatmqks30025i0zksxu34z0o",
    "cmatmqner0027i0zkhwqcr9dk",
    "cmatmqq0t0029i0zk0dbkwguu",
    "cmatmqsfd002bi0zkacc4jgjw",
    "cmatmqut5002di0zk3vyuint3",
    "cmatmqx7g002fi0zkfin1wxvm",
    "cmatmqztw002hi0zkb274cjau",
    "cmatmr2fz002ji0zktj29pk83",
    "cmatmr4td002li0zkhoyef12k",
    "cmatmr774002ni0zk0pz3z3a5",
    "cmatmr9l5002pi0zkioqal9pm",
    "cmatmrc7b002ri0zkxgziiech",
    "cmatmreti002ti0zkeszrrpa9",
    "cmatmrh6z002vi0zk7v3s0fxt",
    "cmatmrjls002xi0zkxpvv2e88",
    "cmatmrm0r002zi0zkx4egg8ys",
    "cmatmronc0031i0zkdm3ke3gp",
    "cmatmrra10033i0zkr36bu3z1",
    "cmatmrtnq0035i0zk3c5ovm1c",
    "cmatmrw270037i0zk2lsa26be",
    "cmatmrygo0039i0zk5cqduihv",
    "cmatms12u003bi0zkj1vc0s9e",
    "cmatms3q2003di0zkk40cz6xg",
    "cmatms63l003fi0zk70iyy79z",
    "cmatms8hh003hi0zkzxfafa2s",
    "cmatmsavn003ji0zkr9gno359",
    "cmatmsdjb003li0zkm3lpnhzy",
    "cmatmsg59003ni0zke8ez26v8",
    "cmatmsij6003pi0zkmt3oldla",
    "cmatmskwv003ri0zkp43aimzq",
    "cmatmsnaz003ti0zkofra47og",
    "cmatmsq08003vi0zki3xghk9u",
    "cmatmssni003xi0zk1qcxr27y",
    "cmatmsv1d003zi0zkejkp2zzp",
    "cmatmsxfi0041i0zka3svlh29",
    "cmatmszt60043i0zkwyw12qip",
    "cmatmt2fr0045i0zkodz5k6mi",
    "cmatmt5230047i0zkwcceyqx4",
    "cmatmt7fr0049i0zkldrnv7dm",
    "cmatmt9to004bi0zkef71u0cm",
    "cmatmtc79004di0zkwweyo8vv",
    "cmatmtetx004fi0zk8skzn8f1",
    "cmatmthgn004hi0zkshh66oon",
    "cmatmtjuq004ji0zkw31jmdpv",
];

function generateDoctorSpecialities(doctorIds, arr) {
    const result = [];
    const maxDoctors = 82;
    const usageMap = new Map(arr.map((val) => [val, 0]));

    // Clone arr for shuffling and rotating
    let availableSpecialities = [...arr];

    // Helper to shuffle an array
    const shuffle = (array) => array.sort(() => Math.random() - 0.5);

    for (let i = 0; i < maxDoctors; i++) {
        const freq = Math.floor(Math.random() * 5) + 1; // Random freq [1,5]

        // Sort specialities based on least usage first (for fairness)
        availableSpecialities.sort((a, b) => usageMap.get(a) - usageMap.get(b));

        // Shuffle top items to prevent fixed ordering
        const topSpecialities = shuffle(
            availableSpecialities.slice(0, Math.max(freq * 2, arr.length))
        );

        // Pick `freq` unique values
        const selected = [];
        const usedSet = new Set();

        while (selected.length < freq) {
            const spec =
                topSpecialities[
                    Math.floor(Math.random() * topSpecialities.length)
                ];
            if (!usedSet.has(spec)) {
                usedSet.add(spec);
                selected.push(spec);
                usageMap.set(spec, usageMap.get(spec) + 1);
            }
        }

        result.push({
            id: doctorIds[i],
            speciality: selected,
        });
    }

    return result;
}

const doctorsWithSpecialities = generateDoctorSpecialities(doctorIds, arr);
console.log(doctorsWithSpecialities);
